"use strict";function each(e,r){for(var t=0;t<e.length;t++)r(e[t],t)}function createFragment(t){if(t.indexOf("<!doctype")>=0)return[(new DOMParser).parseFromString(t,"text/html").childNodes[1]];var e=document.createElement("div");return e.insertAdjacentHTML("beforeend",t),e.childNodes}function createVirtual(e){var t=[];return each(e,function(e){3===e.nodeType?t.push(e.nodeValue):1===e.nodeType&&!function(){var r={};each(e.attributes,function(t){r[t.name]=t.value}),t.push({tag:e.nodeName.toLowerCase(),attrs:r,children:createVirtual(e.childNodes)})}()}),t}function TemplateBuilder(t,e){this.virtual=t,this.level=e,this.virtuals=[]}TemplateBuilder.prototype={addVirtualString:function(t){this.virtuals.push('"'+t.replace(/(["\r\n])/g,"\\$1")+'"')},addVirtualAttrs:function(t){var e="div"===t.tag?"":t.tag;if(t.attrs.class&&(e+="."+t.attrs.class.replace(/\s+/g,"."),t.attrs.class=void 0),each(Object.keys(t.attrs).sort(),function(i){if("style"!==i&&void 0!==t.attrs[i]){e+="["+i+"='";var r=t.attrs[i];r=r.replace(/[\n\r\t]/g," "),r=r.replace(/\s+/g," "),e+=r.replace(/'/g,"\\'")+"']"}}),""===e&&(e="div"),e='"'+e+'"',t.attrs.style){var r=t.attrs.style.replace(/(^.*);\s*$/,"$1"),i=r.replace(/[\n\r]/g,""),a=i.split(/\s*;\s*/),n=a.map(function(t){return t.split(/\s*:\s*/).map(function(t){return'"'+t+'"'}).join(": ")}),l=n.join(", "),s="{"+l+"}";e+=", {style: "+s+"}"}if(0!==t.children.length){var u=new TemplateBuilder(t.children,this.level+1);e+=", "+u.complete()}this.virtuals.push("m("+e+")")},complete:function(){if(each(this.virtual,function(t){"string"==typeof t?!/^\s*$/.test(t)&&t.charCodeAt()>=32&&this.addVirtualString(t):this.addVirtualAttrs(t)}.bind(this)),1===this.virtuals.length&&'"'===this.virtuals[0][0])return this.virtuals.join(", ");var t=this.virtuals.join(",");return"["+t+"]"}};var templateBuilder=function(t){var e=createVirtual(createFragment(t));return new TemplateBuilder(e,1).complete()};"undefined"!=typeof module&&null!==module&&module.exports?module.exports=templateBuilder:"function"==typeof define&&define.amd&&define(function(){return templateBuilder});