"use strict";function each(t,a){for(var e=0;e<t.length;e++)a(t[e],e)}function createFragment(e){if(e.indexOf("<!doctype")>=0)return[(new DOMParser).parseFromString(e,"text/html").childNodes[1]];var t=document.createElement("div");return t.insertAdjacentHTML("beforeend",e),t.childNodes}function createVirtual(t){var e=[];return each(t,function(t){3===t.nodeType?e.push(t.nodeValue):1===t.nodeType&&!function(){var i={};each(t.attributes,function(e){i[e.name]=e.value});var a=t.nodeName.toLowerCase(),r=svgCaseSensitiveTagNamesMap[a]?svgCaseSensitiveTagNamesMap[a]:a;e.push({tag:r,attrs:i,children:createVirtual(t.childNodes)})}()}),e}function TemplateBuilder(e,t){this.virtual=e,this.level=t,this.virtuals=[]}var svgCaseSensitiveTagNames=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"],svgCaseSensitiveTagNamesMap={};svgCaseSensitiveTagNames.forEach(function(e){svgCaseSensitiveTagNamesMap[e.toLowerCase()]=e}),TemplateBuilder.prototype={addVirtualString:function(e){this.virtuals.push('"'+e.replace(/(["\r\n])/g,"\\$1")+'"')},addVirtualAttrs:function(e){var t="div"===e.tag?"":e.tag;if(e.attrs.class&&(t+="."+e.attrs.class.replace(/\s+/g,"."),e.attrs.class=void 0),each(Object.keys(e.attrs).sort(),function(i){if("style"!==i&&void 0!==e.attrs[i]){t+="["+i+"='";var a=e.attrs[i];a=a.replace(/[\n\r\t]/g," "),a=a.replace(/\s+/g," "),t+=a.replace(/'/g,"\\'")+"']"}}),""===t&&(t="div"),t='"'+t+'"',e.attrs.style){var a=e.attrs.style.replace(/(^.*);\s*$/,"$1"),i=a.replace(/[\n\r]/g,""),r=i.split(/\s*;\s*/),n=r.map(function(e){return e.split(/\s*:\s*/).map(function(e){return'"'+e+'"'}).join(": ")}),s=n.join(", "),l="{"+s+"}";t+=", {style: "+l+"}"}if(0!==e.children.length){var o=new TemplateBuilder(e.children,this.level+1);t+=", "+o.complete()}this.virtuals.push("m("+t+")")},complete:function(){if(each(this.virtual,function(e){"string"==typeof e?!/^\s*$/.test(e)&&e.charCodeAt()>=32&&this.addVirtualString(e):this.addVirtualAttrs(e)}.bind(this)),1===this.virtuals.length&&'"'===this.virtuals[0][0])return this.virtuals.join(", ");var e=this.virtuals.join(",");return"["+e+"]"}};var templateBuilder=function(e){var t=createVirtual(createFragment(e));return new TemplateBuilder(t,1).complete()};"undefined"!=typeof module&&null!==module&&module.exports?module.exports=templateBuilder:"function"==typeof define&&define.amd&&define(function(){return templateBuilder});