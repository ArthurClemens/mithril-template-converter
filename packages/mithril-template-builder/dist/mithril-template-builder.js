!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).templateBuilder=e()}(this,function(){"use strict";function t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var a={allowfullscreen:1,allowpaymentrequest:1,async:1,autofocus:1,autoplay:1,checked:1,controls:1,default:1,defer:1,disabled:1,formnovalidate:1,hidden:1,ismap:1,itemscope:1,loop:1,multiple:1,muted:1,nomodule:1,novalidate:1,open:1,readonly:1,required:1,reversed:1,selected:1,typemustmatch:1},o={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient",textpath:"textPath"},c=/(&#?\w+;)/,i=function(t,e){for(var n=0;n<t.length;n++)e(t[n],n)},l=function(t){var e=t.replace(/(^.*);\s*$/,"$1");return(e=e.replace(/[\n\r]/g,"")).split(/\s*;\s*/).map(function(t){return t.split(/\s*:\s*/)})},f=function(t){return t.reduce(function(t,e){var r=n(e,2),a=r[0],o=r[1];return t[a]=o,t},{})};function u(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).attrsAsObject;this.virtual=t,this.attrsAsObject=e,this.children=[]}u.prototype={addVirtualString:function(t){var e=this,n=t.replace(/(["\r\n])/g,"\\$1"),r=n.split(c);r.length>1?r.forEach(function(t){t.match(c)?e.children.push({content:'m.trust("'.concat(t,'")')}):t&&e.children.push({content:'"'.concat(t,'"')})}):this.children.push({content:'"'.concat(n,'"')})},addVirtualAttrs:function(n){var r={tag:"",className:"",attrsAsString:"",attrsAsObject:"",style:""},a=n.attrs,o=a.class,c=void 0===o?"":o,i=a.style,s=void 0===i?"":i,d=e(a,["class","style"]),h=Object.keys(d).filter(function(t){return void 0!==d[t]}).reduce(function(t,e){return t[e]=d[e],t},{});if(this.attrsAsObject){var p=s?f(l(s)):{},g=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),a.forEach(function(n){t(e,n,r[n])})}return e}({},c.length>0?{class:c}:{},h,Object.keys(p).length>0?{style:p}:{});r.tag=n.tag||"div",Object.keys(g).length>0&&(r.attrsAsObject=", ".concat(JSON.stringify(g)))}else if(r.tag="div"===n.tag?0===Object.keys(h).length?"div":"":n.tag,r.className=c?".".concat(c.replace(/\s+/g,".")):"",r.attrsAsString=Object.keys(h).map(function(t){var e=h[t].replace(/[\n\r\t]/g," ").replace(/\s+/g," ").replace(/'/g,"\\'");return"[".concat(t,"='").concat(e,"']")}).join(""),s){var m=l(s),y=f(m),v=JSON.stringify(y);r.style=', {"style":'.concat(v,"}")}var b=0!==n.children.length?new u(n.children,{attrsAsObject:this.attrsAsObject}).complete():null;this.children.push({node:function(t){var e=t.tag,n=t.className,r=t.attrsAsString,a=t.attrsAsObject,o=t.style;return'"'.concat(e).concat(n).concat(r,'"').concat(a).concat(o)}(r),children:b})},complete:function(){return i(this.virtual,function(t){if("string"==typeof t){var e=t.trim(),n=e.charCodeAt(0);0===e.length||'"'===e||1===e.length&&10===n||!(10===n||n>=32)||this.addVirtualString(e)}else this.addVirtualAttrs(t)}.bind(this)),this.children}};var s={2:"  ",4:"    ",tab:"\t"};return function(t){var e,n=new u(function t(e){var n=[];return i(e,function(e){if(3===e.nodeType)n.push(e.nodeValue);else if(1===e.nodeType){var r={};i(e.attributes,function(t){var e=t.name,n=t.value;r[e]=a[e]?e:n});var c=e.nodeName.toLowerCase(),l=o[c]||c;n.push({tag:l,attrs:r,children:t(e.childNodes)})}}),n}(function(t){if((t=t.replace(/&/g,"&amp;")).indexOf("<!doctype")>=0)return[(new DOMParser).parseFromString(t,"text/html").childNodes[1]];var e=document.createElement("div");return e.insertAdjacentHTML("beforeend",t),r(e.childNodes)}(t.source)),{attrsAsObject:t.attrsAsObject}).complete(),c=function t(e,n,r){if(e)return e.map(function(e){var a=function(t,e){if(t<0)return"";for(var n="",r=0;r<t;r++)n+=e;return n}(n,r);if(e.content)return function(t,e){return"\n".concat(e).concat(t)}(e.content,a);var o=e.node||"",c=n+(e.children&&e.children.length>1?2:1);return function(t,e,n,r){return e?e.length>1?function(t,e,n,r){return"\n".concat(n,"m(").concat(t,",\n").concat(n).concat(r,"[").concat(e,"\n").concat(n).concat(r,"]\n").concat(n,")")}(t,e,n,r):function(t,e,n){return"\n".concat(n,"m(").concat(t,", ").concat(e,"\n").concat(n,")")}(t,e,n):function(t,e){return"\n".concat(e,"m(").concat(t,")")}(t,n)}(o,t(e.children,c,r),a,r)})}(n,n.length>1?1:0,s[t.indent||"2"]);return c.length>1?(e=c.join(", "),"[".concat(e,"\n]")):c.join("").trim()}});
//# sourceMappingURL=mithril-template-builder.js.map
