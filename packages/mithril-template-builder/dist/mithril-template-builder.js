!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).templateBuilder=e()}(this,function(){"use strict";function t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t,e){if(null==t)return{};var n,r,c=function(t,e){if(null==t)return{};var n,r,c={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(c[n]=t[n]);return c}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(c[n]=t[n])}return c}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,c=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){c=!0,o=t}finally{try{r||null==i.return||i.return()}finally{if(c)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c=/(&#?\w+;)/,o={};["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].forEach(function(t){o[t.toLowerCase()]=t});var a=function(t,e){for(var n=0;n<t.length;n++)e(t[n],n)},i=function(t){var e=t.replace(/(^.*);\s*$/,"$1");return(e=e.replace(/[\n\r]/g,"")).split(/\s*;\s*/).map(function(t){return t.split(/\s*:\s*/)})},l=function(t){return t.reduce(function(t,e){var r=n(e,2),c=r[0],o=r[1];return t[c]=o,t},{})};function u(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).attrsAsObject;this.virtual=t,this.attrsAsObject=e,this.children=[]}u.prototype={addVirtualString:function(t){var e=this,n=t.replace(/(["\r\n])/g,"\\$1"),r=n.split(c);r.length>1?r.forEach(function(t){t.match(c)?e.children.push({content:'m.trust("'.concat(t,'")')}):t&&e.children.push({content:'"'.concat(t,'"')})}):this.children.push({content:'"'.concat(n,'"')})},addVirtualAttrs:function(n){var r={tag:"",className:"",attrsAsString:"",attrsAsObject:"",style:""},c=n.attrs,o=c.class,a=void 0===o?"":o,s=c.style,f=void 0===s?"":s,h=e(c,["class","style"]),d=Object.keys(h).filter(function(t){return void 0!==h[t]}).reduce(function(t,e){return t[e]=h[e],t},{});if(this.attrsAsObject){var p=f?l(i(f)):{},g=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},c=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(c=c.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),c.forEach(function(n){t(e,n,r[n])})}return e}({},a.length>0?{class:a}:{},h,Object.keys(p).length>0?{style:p}:{});r.tag=n.tag||"div",Object.keys(g).length>0&&(r.attrsAsObject=", ".concat(JSON.stringify(g)))}else if(r.tag="div"===n.tag?0===Object.keys(d).length?"div":"":n.tag,r.className=a?".".concat(a.replace(/\s+/g,".")):"",r.attrsAsString=Object.keys(d).map(function(t){var e=n.attrs[t].replace(/[\n\r\t]/g," ").replace(/\s+/g," ").replace(/'/g,"\\'");return"[".concat(t,"='").concat(e,"']")}).join(""),f){var y=i(f),m=l(y),v=JSON.stringify(m);r.style=', {"style":'.concat(v,"}")}var b=0!==n.children.length?new u(n.children,{attrsAsObject:this.attrsAsObject}).complete():null;this.children.push({node:function(t){var e=t.tag,n=t.className,r=t.attrsAsString,c=t.attrsAsObject,o=t.style;return'"'.concat(e).concat(n).concat(r,'"').concat(c).concat(o)}(r),children:b})},complete:function(){return a(this.virtual,function(t){if("string"==typeof t){var e=t.trim(),n=e.charCodeAt(0);0===e.length||'"'===e||1===e.length&&10===n||!(10===n||n>=32)||this.addVirtualString(e)}else this.addVirtualAttrs(t)}.bind(this)),this.children}};var s=function t(e,n,r){if(e)return e.map(function(e){var c=function(t,e){if(t<0)return"";for(var n="",r=0;r<t;r++)n+=e;return n}(n,r);if(e.content)return function(t,e){return"\n".concat(e).concat(t)}(e.content,c);var o=e.node||"",a=n+(e.children&&e.children.length>1?2:1);return function(t,e,n,r){return console.log("children",e),e?e.length>1?function(t,e,n,r){return"\n".concat(n,"m(").concat(t,",\n").concat(n).concat(r,"[").concat(e,"\n").concat(n).concat(r,"]\n").concat(n,")")}(t,e,n,r):function(t,e,n){return"\n".concat(n,"m(").concat(t,", ").concat(e,"\n").concat(n,")")}(t,e,n):function(t,e){return"\n".concat(e,"m(").concat(t,")")}(t,n)}(o,t(e.children,a,r),c,r)})},f={2:"  ",4:"    ",tab:"\t"};return function(t){var e,n=new u(function t(e){var n=[];return a(e,function(e){if(3===e.nodeType)n.push(e.nodeValue);else if(1===e.nodeType){var r={};a(e.attributes,function(t){r[t.name]=t.value});var c=e.nodeName.toLowerCase(),i=o[c]?o[c]:c;n.push({tag:i,attrs:r,children:t(e.childNodes)})}}),n}(function(t){if((t=t.replace(/&/g,"&amp;")).indexOf("<!doctype")>=0)return[(new DOMParser).parseFromString(t,"text/html").childNodes[1]];var e=document.createElement("div");return e.insertAdjacentHTML("beforeend",t),r(e.childNodes)}(t.source)),{attrsAsObject:t.attrsAsObject}).complete(),c=n.length>1?1:0,i=f[t.indent||"2"],l=s(n,c,i);return l.length>1?(e=l.join(", "),"[".concat(e,"\n]")):l.join("").trim()}});
//# sourceMappingURL=mithril-template-builder.js.map
