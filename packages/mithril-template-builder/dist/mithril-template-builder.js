!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).polythene={})}(this,function(t){"use strict";var e=/(&#?\w+;)/,n={};function r(t,e){for(var n=0;n<t.length;n++)e(t[n],n)}function c(t){this.virtual=t,this.children=[]}["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].forEach(function(t){n[t.toLowerCase()]=t}),c.prototype={addVirtualString:function(t){var n=this,r=t.replace(/(["\r\n])/g,"\\$1"),c=r.split(e);c.length>1?c.forEach(function(t){t.match(e)?n.children.push({content:'m.trust("'.concat(t,'")')}):t&&n.children.push({content:'"'.concat(t,'"')})}):this.children.push({content:'"'.concat(r,'"')})},addVirtualAttrs:function(t){var e="div"===t.tag?"":t.tag;if(t.attrs.class){var n=t.attrs.class.replace(/\s+/g,".");e+=".".concat(n),t.attrs.class=void 0}if(r(Object.keys(t.attrs).sort(),function(n){if("style"!==n&&void 0!==t.attrs[n]){var r=t.attrs[n];r=(r=(r=r.replace(/[\n\r\t]/g," ")).replace(/\s+/g," ")).replace(/'/g,"\\'"),e+="[".concat(n,"='").concat(r,"']")}}),""===e&&(e="div"),e='"'.concat(e,'"'),t.attrs.style){var a=t.attrs.style.replace(/(^.*);\s*$/,"$1");a=(a=(a=(a=a.replace(/[\n\r]/g,"")).split(/\s*;\s*/)).map(function(t){return t.split(/\s*:\s*/).map(function(t){return'"'.concat(t,'"')}).join(": ")})).join(", "),e+=", {style: {".concat(a,"}}")}var o=0!==t.children.length?new c(t.children).complete():null;this.children.push({node:e,children:o})},complete:function(){return r(this.virtual,function(t){if("string"==typeof t){var e=t.trim(),n=e.charCodeAt();0===e.length||'"'===e||1===e.length&&10===n||!(10===n||n>=32)||this.addVirtualString(e)}else this.addVirtualAttrs(t)}.bind(this)),this.children}};var a={2:"  ",4:"    ",tab:"\t"};t.templateBuilder=function(t){var e,o=new c(function t(e){var c=[];return r(e,function(e){if(3===e.nodeType)c.push(e.nodeValue);else if(1===e.nodeType){var a={};r(e.attributes,function(t){a[t.name]=t.value});var o=e.nodeName.toLowerCase(),i=n[o]?n[o]:o;c.push({tag:i,attrs:a,children:t(e.childNodes)})}}),c}(function(t){if((t=t.replace(/&/g,"&amp;")).indexOf("<!doctype")>=0)return[(new DOMParser).parseFromString(t,"text/html").childNodes[1]];var e=document.createElement("div");return e.insertAdjacentHTML("beforeend",t),e.childNodes}(t.source))).complete(),i=function t(e,n,r){return e?e.map(function(e){var c=function(t,e){if(t<0)return"";for(var n="",r=0;r<t;r++)n+=e;return n}(n,r);if(e.content)return function(t,e){return"\n".concat(e).concat(t)}(e.content,c);var a=e.node||"",o=n+(e.children&&e.children.length>1?2:1);return function(t,e,n,r){return e?e.length>1?function(t,e,n,r){return"\n".concat(n,"m(").concat(t,",\n").concat(n).concat(r,"[").concat(e,"\n").concat(n).concat(r,"]\n").concat(n,")")}(t,e,n,r):function(t,e,n){return"\n".concat(n,"m(").concat(t,", ").concat(e,"\n").concat(n,")")}(t,e,n):function(t,e,n){return"\n".concat(n,"m(").concat(t,")")}(t,0,n)}(a,t(e.children,o,r)||"",c,r)}):""}(o,o.length>1?1:0,a[t.indent||"4"]);return i.length>1?(e=i.join(", "),"[".concat(e,"\n]")):i.join("").trim()},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mithril-template-builder.js.map
